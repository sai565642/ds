#include<stdio.h>
#include<string.h>
#define MAX 100
//define structure
struct friend 
{
    char name[50];
    char mob [15];
};
//insert into sorted array
int insertsorted(struct friend friends[],int *n,char name[],char mob[])
{
    if (*n>=MAX)
    {
        printf("\n phonebook is full cannot insert\n");
        return 0;
    }
    //shift element to make room 
    int i=*n-1;
    while(i>=0 && strcmp(friends[i].name,name)>0)
    {
        friends[i+1]=friends[i];
        i--;
    }
    //insert at correct position
    strcpy (friends[i+1].name ,name);
    strcpy (friends[i+1].mob,mob);
    return 1;
}
//binary search non recursive
int binarysearch(struct friend friends[],int n,char target[])
{ 
    int low=0;
    int high= n-1;
    while(low<=high)
    {
        int mid=(low+high)/2;
        int cmp =strcmp(target,friends[mid].name);
        if(cmp==0){
            return mid;}
        else if(cmp<mid)
            high =mid-1;
        else 
            low=mid+1;
        }
        return -1;
    }
// binary search for recursive
int binarysearchrecursive (struct friend friends[],int low,int high,char target[])
{
	if(low>high)
	    return -1;
	int mid=(low+high)/2;
	int cmp=strcmp(target,friends[mid].name);
	if (cmp==0)
	    return mid;
	else if (cmp<0)
	    return binarysearchrecursive(friends,low,mid-1,target);
	else
	    return binarysearchrecursive(friends,mid+1,high,target);
}    
    
int main()
{
    struct friend friends [MAX];
    int n;
    printf("enter number of friends :\n");
    scanf("%d",&n);
    if(n<1||n>MAX)
    {
        printf("\n invalid number MAX allowed: %d \n",MAX);
        return 1;
    }
    // input and insert in sorted order
    for(int i=0;i<n;i++)
    {
    char name[50];
    char mob [15];
    printf("\n friend %d \n",i+1);
    printf("\n enter name:");
    scanf("%s",name);
    printf("\n enter mob number:");
    scanf("%s",mob);
    insertsorted(friends,&i,name,mob);
    }
    printf("\n sorted phonebook:\n");
    for (int i=0;i<n;i++)
    {
        printf("%d. %s = %s \n",i+1,friends[i].name,friends[i].mob);
    }

    char searchname[50];
    //by non recursive
    printf("\n enter name to search:\n");
    scanf("%s",&searchname);
    int index=binarysearch(friends,n,searchname);
    if(index!=-1)
    {
        printf("\n friend found: %s - %s \n",friends[index].name,friends[index].mob);
    }
    else
    {
        printf("\n friend not found");
        printf("\n adding friend in phonbook \n");
        char newmob[15];
        printf("\n enter mobile of %s \n",searchname);
        scanf("%s",newmob);
        if (insertsorted(friends,&n,searchname,newmob))
        {
            printf("\n friend inserted \n");
            n++;
        }
    }
    printf("updated phonebook:\n");
    for(int i=0;i<n;i++)
    {
        printf("%d. %s = %s \n",i+1,friends[i].name,friends[i].mob);
    }
    //by recursive
    printf("\n enter name to search:");
    scanf("%s",&searchname);
    int inde=binarysearchrecursive(friends,0,n,searchname);
    
    if(inde!=-1)
    {
        printf("\n friend found: %s - %s \n",friends[inde].name,friends[inde].mob);
    }
    else
    {
        printf("\n friend not found");
        printf("\n adding friend in phonebook... \n");
        char newmob[15];
        printf("\n enter mobile of %s :",searchname);
        scanf("%s",newmob);
        if (insertsorted(friends,&n,searchname,newmob))
        {
            printf("\n friend inserted ...\n");
            n++;
        }
    }
    printf("updated phonebook:\n");
    for(int i=0;i<n;i++)
    {
        printf("%d. %s = %s \n",i+1,friends[i].name,friends[i].mob);
    }
    return 0;
}